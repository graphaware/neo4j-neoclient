language: php
php:
    - 5.5
    - 5.6
    - 7.0

matrix:
  include:
  - php: "5.5"
    env: ADD_REQ=""
  - php: "5.6"
    env: ADD_REQ="composer require `grep -E '(graphaware/neo4j-bolt)' composer.json | tr -d '\" ' `"
  - php: "7.0"
    env: ADD_REQ="composer require `grep -E '(graphaware/neo4j-bolt)' composer.json | tr -d '\" ' `"

before_install:
    - sudo apt-get update > /dev/null
    # install Oracle JDK8
    - sh -c ./build/install-jdk8.sh
    # install and launch neo4j
    - sh -c ./build/install-neo.sh
    # Add bolt
    - eval $ADD_REQ
    - composer self-update
    - travis_retry composer install --prefer-source --no-interaction

script:
    - vendor/bin/phpunit --exclude-group fail

notifications:
    email: "christophe@graphaware.com"
